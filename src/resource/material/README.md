# Material Resource System

The Material Resource System provides functionality for loading, managing, and hot-reloading material assets in the Aphrodite Engine. It's part of the larger resource management system and follows similar patterns to other resource types.

## Components

The system consists of the following components:

- **MaterialAsset**: Represents a loaded material resource
- **MaterialLoader**: Handles loading and hot-reloading of material assets
- **MaterialLoadInfo**: Contains information needed to load a material

## Loading Materials

Materials are loaded using the MaterialLoader or through the ResourceLoader interface. Both synchronous and asynchronous loading are supported.

### Example Usage

```cpp
// Direct usage
aph::MaterialLoadInfo loadInfo{
    .debugName = "metal_material",
    .path = "materials://metal.mat.toml",
    .pRegistry = pMaterialRegistry,
    .enableHotReload = true
};

aph::MaterialAsset* pMaterialAsset = nullptr;
auto materialLoader = new aph::MaterialLoader();
materialLoader->initialize(pMaterialRegistry);
materialLoader->load(loadInfo, &pMaterialAsset);

// Usage through ResourceLoader
aph::LoadRequest loadRequest = pResourceLoader->createRequest();
aph::MaterialAsset* pMaterialAsset = nullptr;
loadRequest.add(loadInfo, &pMaterialAsset);
loadRequest.load();

// Get the material instance
aph::Material* pMaterial = pMaterialAsset->getMaterial();
```

## Hot Reloading

The system supports automatic hot reloading of material assets when the source file changes. This is enabled by setting `enableHotReload` to true in the MaterialLoadInfo.

To trigger hot reloading checks, call the `update` method on MaterialLoader periodically:

```cpp
// Call this each frame
materialLoader->update();
```

## Material File Format

Materials are stored in TOML format with the following structure:

```toml
# Material asset generated by Aphrodite Engine

[material]
name = "Metal"
template = "StandardPBR"
domain = "Opaque"
features = ["Albedo", "Metallic", "Roughness", "Normal", "AO"]

[parameters]
baseColor = [0.9, 0.9, 0.9, 1.0]
metallic = 1.0
roughness = 0.2

[textures]
albedoMap = "textures://metal/albedo.tex"
normalMap = "textures://metal/normal.tex"
metallicRoughnessMap = "textures://metal/metal_roughness.tex"
```

## Integration with Material System

The Material Resource System integrates with the Material System, which provides:

- **MaterialRegistry**: Registry for material templates and factory for material instances
- **MaterialTemplate**: Defines the structure and layout of a material type
- **Material**: Concrete instance of a material with specific parameter values

The MaterialAsset acts as a wrapper around the Material instance, providing lifecycle management and hot-reloading capabilities.

## Error Handling

All operations return an aph::Result to indicate success or failure. When using the ResourceLoader interface, errors are stored in the LoadRequest and can be queried after loading.

## Implementation Notes

- Materials are parsed using a simplistic TOML parser (to be replaced with a proper TOML library)
- Hot reloading checks are rate-limited to avoid excessive file system operations
- MaterialAsset owns the Material instance and manages its lifecycle 